<!DOCTYPE html>
<html lang="zh-tw">
<head>
    <meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<!--Description-->



    <meta name="description" content="MIT &#39;23, Computer Sceince"/>


<!--Author-->

    <meta name="author" content="Utaha"/>


<!--Open Graph Title-->

    <meta property="og:title" content="Imaginary CTF 2021"/>


<!--Open Graph Description-->

    <meta property="og:description" content="MIT &#39;23, Computer Sceince"/>


<!--Open Graph Site Name-->
    <meta property="og:site_name" content="Utaha&#39;s CTF Note"/>

<!--Type page-->

    <meta property="og:type" content="article"/>


<!--Page Cover-->


    <meta property="og:image" content="https://utaha1228.github.io/ctf-note/img/home-bg.jpg"/>


<meta name="twitter:card" content="summary_large_image"/>




    <meta name="twitter:image" content="https://utaha1228.github.io/ctf-note/img/home-bg.jpg"/>


<!-- Title -->

<title>Imaginary CTF 2021 | Utaha&#39;s CTF Note</title>

<!-- Bootstrap Core CSS -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css">

<!-- Custom CSS -->

<link rel="stylesheet" href="/ctf-note/css/main.css">


<!-- Custom Fonts -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.0/css/all.min.css" />
<link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.0/css/all.min.css" />
<link href="//fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Gallery -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/featherlight@1.4.0/src/featherlight.css" integrity="sha256-30DV/STftlyQ6v8yaOWlabammvCYtRJERLj/m0b3zno=" crossorigin="anonymous">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/lightgallery@1.6.11/dist/css/lightgallery.min.css">

<!-- favicon -->

<link rel="icon" href="/ctf-note/img/favicon.png"/>



    <!-- Google Analytics -->
    


<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head>
<!-- Head tag -->

<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top bg-transparent position-absolute w-100 p-0" id="nav">
    <div class="container pl-0 pr-0">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <a class="navbar-brand text-white p-1 pl-3" href="/ctf-note/">Utaha's CTF Note</a>
        </div>
        <div>
            <!--  -->
            
                <li class="list-inline-item">
                    <!-- 
                     -->
                    <a class = "navbar-list text-white p-1 pl-3" style = "text-decoration: none;" href="/ctf-note/">
                        
                            Home
                        
                    </a>
                </li>
            
                <li class="list-inline-item">
                    <!-- 
                        <span class="copyright-split">&nbsp;|&nbsp;</span>
                    
                     -->
                    <a class = "navbar-list text-white p-1 pl-3" style = "text-decoration: none;" href="/ctf-note/archives">
                        
                            Archives
                        
                    </a>
                </li>
            
                <li class="list-inline-item">
                    <!-- 
                        <span class="copyright-split">&nbsp;|&nbsp;</span>
                    
                     -->
                    <a class = "navbar-list text-white p-1 pl-3" style = "text-decoration: none;" href="/ctf-note/tags/writeup">
                        
                            Tags
                        
                    </a>
                </li>
            
                <li class="list-inline-item">
                    <!-- 
                        <span class="copyright-split">&nbsp;|&nbsp;</span>
                    
                     -->
                    <a class = "navbar-list text-white p-1 pl-3" style = "text-decoration: none;" href="/ctf-note/about">
                        
                            About
                        
                    </a>
                </li>
            
        </div>
        <div class="navbar-nav float-right">
            <button class="btn btn-link search-btn navbar-item" data-toggle="modal" data-target="#searchModal">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/ctf-note/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-md-12 text-center">
                <div class="post-heading text-white">
                    <h1>Imaginary CTF 2021</h1>
                    
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Main Content -->
            <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1">
                
                    <span class="meta d-inline-block">
    
    
    <!-- Date -->
    
        <span class="post-meta-split">&nbsp;|&nbsp;</span>
        <i class="far fa-calendar-check fa-fw"></i>
        2021-07-28
    
    <!-- word count and read count -->
    

    

    
        <span class="post-meta-split">&nbsp;|&nbsp;</span>
        <i class="far fa-eye fa-fw"></i>
        <span id="busuanzi_value_page_pv"></span>
    
</span>  
                
                <h2 id="intro">Intro</h2>
<p>The crypto problems were not too hard and there were nothing new and
special except the last crypto problem "ZKPoD". This was my first time
to implement LSB oracle attack, and the code was pretty messy. I
refactored it based on <a
target="_blank" rel="noopener" href="https://oalieno.github.io/old/security/crypto/asymmetric/rsa/lsb-oracle/">oalieno's
tutorial</a>.</p>
<h2 id="zkpod">ZKPoD</h2>
<h3 id="description">Description</h3>
<p>The problem has two modules. The first module is an RSA with fixed
2048-bit <span class="math inline">\(N\)</span> and <span
class="math inline">\(e = 65537\)</span>, and the second one is a
signing process with a 2048-bit prime <span
class="math inline">\(p\)</span> and <span class="math inline">\(g =
2\)</span>. The signing process works as follow:</p>
<ul>
<li>Randomly choose a <span class="math inline">\(k\)</span> between
<span class="math inline">\(0\)</span> to <span class="math inline">\((p
- 2)\)</span>. Let <span class="math inline">\(r = g^k \pmod
p\)</span></li>
<li><span class="math inline">\(e\)</span> is a 1024-bit hash of <span
class="math inline">\(r\)</span>, and <span class="math inline">\(s = (k
- me) \pmod{p - 1}\)</span>, where <span
class="math inline">\(m\)</span> is the message to be signed.</li>
<li>The signature is <span class="math inline">\((r, s)\)</span></li>
</ul>
<p>The problem first gives us the RSA-encrypted flag, then provide an
oracle that decrypts the input and signs it.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">0xbb00128c1c1555dc8fc1cd09b3bb2c3efeaae016fcb336491bd022f83a10a501175c044843dbec0290c5f75d9a93710246361e4822331348e9bf40fc6810d5fc7315f37eb8f06fb3f0c0e9f63c2c207c29f367dc45eef2e5962eff35634b7a29d913a59cd0918fa395571d3901f8abd83322bd17b60fd0180358b7e36271adcfc1f9105b41da6950a17dba536a2b600f2dc35e88c4a9dd208ad85340de4d3c6025d1bd6e03e9449f83afa28b9ff814bd5662018be9170b2205f38cf3b67ba5909c81267daa711fcdb8c7844bbc943506e33f5f72f603119526072efbc5ceae785f2af634e6c7d2dd0d51d6cfd34a3bc2b15a752918d4090d2ca253df4ef47b8b</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">P = <span class="number">0x199e1926f2d2d5967b1d230b33de0a249f958e5b962f8b82ca042970180fe1505607fe4c8cde04bc6d53aec53b4aa25255ae67051d6ed9b602b1b19e128835b20227db7ee19cf88660a50459108750f8b96c71847e4f38a79772a089aa46666404fd671ca17ea36ee9f401b4083f9ca76f5217588c6a15baba7eb4a0934e2026937812c96e2a5853c0e5a65231f3eb9fdc283e4177a97143fe1a3764dc87fd6d681f51f49f6eed5ab7ddc2a1da7206f77b8c7922c5f4a5cfa916b743ceeda943bc73d821d2f12354828817ff73bcd5800ed201c5ac66fa82df931c5bbc76e03e48720742ffe673b7786e40f243d7a0816c71eb641e5d58531242f7f5cfef60e5b</span></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign</span>(<span class="params">x</span>):</span></span><br><span class="line">    k = getRandomRange(<span class="number">0</span>, P - <span class="number">1</span>)</span><br><span class="line">    r = <span class="built_in">pow</span>(g, k, P)</span><br><span class="line">    e = H(r) <span class="comment"># a robust deterministic hash function </span></span><br><span class="line">    s = (k - x * e) % (P - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> r, s</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(flag, e, N))</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&gt; &quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    c = <span class="built_in">int</span>(<span class="built_in">input</span>(), <span class="number">16</span>)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">    r, s = sign(m)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;r: <span class="subst">&#123;r&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;s: <span class="subst">&#123;s&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="solution">Solution</h3>
<h4 id="recover-lsb">Recover LSB</h4>
<p>The decryption oracle reminds us of the famous LSB oracle attack, but
can we recover the least significant bit of <span
class="math inline">\(m\)</span> from the signature? The answer is yes.
Since we know <span class="math inline">\(r\)</span> and <span
class="math inline">\(e\)</span>, we can calculate</p>
<p><span class="math display">\[g^{me} \equiv \left(\frac{r}{g^s}\right)
\pmod p\]</span></p>
<p>if <span class="math inline">\(e\)</span> is invertible modulo <span
class="math inline">\((p - 1)\)</span>, then</p>
<p><span class="math display">\[g^m \equiv \left(g^{em}\right)^{e^{-1}}
\pmod p\]</span></p>
<p>where <span class="math inline">\(e^{-1}\)</span> is the inverse of
<span class="math inline">\(e\)</span> modulo <span
class="math inline">\((p-1)\)</span>. Luckily, <span
class="math inline">\(g\)</span> is a primitive root of <span
class="math inline">\(p\)</span>, so</p>
<p><span class="math display">\[g^m \text{ is a quadratic residue}
\Leftrightarrow 2 \mid m\]</span></p>
<p>meaning we can recover the least significant bit of <span
class="math inline">\(m\)</span> easily by Euler's formula.</p>
<p>There are two important details:</p>
<ul>
<li><span class="math inline">\(e\)</span> is not always invertible. We
may have to ask for the signature of the same message multiple times,
until we get a signature with invertible <span
class="math inline">\(e\)</span>.</li>
<li>This only works when <span class="math inline">\(N &lt; p\)</span>.
If <span class="math inline">\(p\)</span> is small, the least
significant bit may be destroyed because of the modulo <span
class="math inline">\((p - 1)\)</span> operation. Formally, we use the
fact that <code>m % N % (p - 1) = m % N</code>.</li>
</ul>
<h4 id="lsb-oracle-attack">LSB oracle attack</h4>
<p>It is a well known attack, and below we provide the essential idea of
the attack.</p>
<p>Let the encrypted flag and flag be <span
class="math inline">\(c\)</span> and <span
class="math inline">\(f\)</span>, respectively. The crucial observation
is that when we feed in the input <span
class="math inline">\(2^ec\)</span>, the decrypted message will be <span
class="math inline">\(dm = 2f \pmod N\)</span>. If <span
class="math inline">\(2f \ge N\)</span>, then <span
class="math inline">\(dm = 2f-N\)</span>, an odd number; otherwise,
<span class="math inline">\(dm = 2f\)</span>, an even number. This
observation implies that based on the least significant bit of <span
class="math inline">\(dm\)</span>, we can know if <span
class="math inline">\(f\)</span> is in <span class="math inline">\([0,
\frac{N}{2})\)</span> or <span class="math inline">\([\frac{N}{2},
N)\)</span>. In the next round, we feed in <span
class="math inline">\(4^ec\)</span> and so on, and we are able to binary
search the value of <span class="math inline">\(f\)</span>.</p>
<p>The script is as follow:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;chal.imaginaryctf.org&quot;</span>, <span class="number">42012</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;Here&#x27;s my encrypted flag: &quot;</span>)</span><br><span class="line">enc_flag = <span class="built_in">int</span>(r.recvline().strip(<span class="string">b&quot;\n&quot;</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">H</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> bytes_to_long(hashlib.sha512(<span class="string">b&quot;domain&quot;</span> + x).digest() + hashlib.sha512(<span class="string">b&quot;separation&quot;</span> + x).digest())</span><br><span class="line"></span><br><span class="line">N = <span class="number">0xbb00128c1c1555dc8fc1cd09b3bb2c3efeaae016fcb336491bd022f83a10a501175c044843dbec0290c5f75d9a93710246361e4822331348e9bf40fc6810d5fc7315f37eb8f06fb3f0c0e9f63c2c207c29f367dc45eef2e5962eff35634b7a29d913a59cd0918fa395571d3901f8abd83322bd17b60fd0180358b7e36271adcfc1f9105b41da6950a17dba536a2b600f2dc35e88c4a9dd208ad85340de4d3c6025d1bd6e03e9449f83afa28b9ff814bd5662018be9170b2205f38cf3b67ba5909c81267daa711fcdb8c7844bbc943506e33f5f72f603119526072efbc5ceae785f2af634e6c7d2dd0d51d6cfd34a3bc2b15a752918d4090d2ca253df4ef47b8b</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">p = <span class="number">0x199e1926f2d2d5967b1d230b33de0a249f958e5b962f8b82ca042970180fe1505607fe4c8cde04bc6d53aec53b4aa25255ae67051d6ed9b602b1b19e128835b20227db7ee19cf88660a50459108750f8b96c71847e4f38a79772a089aa46666404fd671ca17ea36ee9f401b4083f9ca76f5217588c6a15baba7eb4a0934e2026937812c96e2a5853c0e5a65231f3eb9fdc283e4177a97143fe1a3764dc87fd6d681f51f49f6eed5ab7ddc2a1da7206f77b8c7922c5f4a5cfa916b743ceeda943bc73d821d2f12354828817ff73bcd5800ed201c5ac66fa82df931c5bbc76e03e48720742ffe673b7786e40f243d7a0816c71eb641e5d58531242f7f5cfef60e5b</span></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">oracle</span>(<span class="params">payload</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">            r.sendline(<span class="built_in">hex</span>(payload).encode())</span><br><span class="line">            r.recvuntil(<span class="string">b&quot;r: &quot;</span>)</span><br><span class="line">            _r = <span class="built_in">int</span>(r.recvline().strip(<span class="string">b&quot;\n&quot;</span>))</span><br><span class="line">            r.recvuntil(<span class="string">b&quot;s: &quot;</span>)</span><br><span class="line">            _s = <span class="built_in">int</span>(r.recvline().strip(<span class="string">b&quot;\n&quot;</span>))</span><br><span class="line">            e = H(<span class="built_in">str</span>(_r).encode() + <span class="string">b&quot;Haha, arbitrary message&quot;</span>)</span><br><span class="line">            d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p - <span class="number">1</span>))</span><br><span class="line">            gm = <span class="built_in">pow</span>(_r * <span class="built_in">pow</span>(g, -_s, p), d, p)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">pow</span>(gm, (p - <span class="number">1</span>) // <span class="number">2</span>, p) == <span class="number">1</span>: <span class="comment"># Euler&#x27;s Formula</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span> ValueError: <span class="comment"># if e is not invertible</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Bad e :(&quot;</span>)</span><br><span class="line"></span><br><span class="line">L = <span class="number">0</span></span><br><span class="line">R = N</span><br><span class="line">rd = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> L != R - <span class="number">1</span>:</span><br><span class="line">    mid = (L + R) // <span class="number">2</span></span><br><span class="line">    rd += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(rd)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> R &gt; (<span class="number">1</span> &lt;&lt; <span class="number">400</span>):</span><br><span class="line">        R = mid</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    payload = enc_flag &lt;&lt; (rd * e)</span><br><span class="line">    payload %= N</span><br><span class="line">    <span class="keyword">if</span> oracle(payload):</span><br><span class="line">        R = mid</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        L = mid</span><br><span class="line"></span><br><span class="line">flag = L</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(flag)[<span class="number">2</span>:]))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

            </div>

            <!-- Post information -->
            
    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 post-tags">
        
            <i class="fas fa-tag" style="vertical-align: middle;font-size: .8rem;"></i>
            tags:&nbsp;
            
            
        
            <a href="/ctf-note/tags/writeup/">#writeup</a>
        
    </div>

            
    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1">
        <ul class="pagination d-block text-center">
            
                <li class="previous page-item d-inline"><a href="/ctf-note/2021/08/01/Elliptic-Curve-Form/" class="page-link float-left">&larr;  Newer Posts</a></li>
            
            
                <li class="next page-item d-inline"><a href="/ctf-note/2021/07/24/IJCTF-2021/" class="page-link float-right">Older Posts  &rarr;</a></li>
            
        </ul>
    </div>


            
                <!-- Comments -->
                

                

            

        </div>
    </div>
</article> 


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    <style>
        #toc-content .toc-link::before {
            background-color: transparent;
            max-height: 25px;
        }

        #toc-content .toc-link.is-active-link::before {
            background-color: #404040;
        }
    </style>
    <script src="//cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <div class="ui-toc dropup scrollspy-body pull-right" style="right: 3%;">
        <button type="button" class="toc-btn btn btn-light" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-display="static">
            <i class="fas fa-list"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-right p-2"  aria-labelledby="tocLabel">
            <div class="toc-widget">
                <div id="toc-content" class="text-truncate">
                </div>
            </div>
            <div class="toc-menu pt-3 pl-4">
                <a class="expand-toggle d-block py-1" href="#"><span class="expand-text">Expand all</span><span class="close-text" style="display: none;">Collapse all</span></a>
                <a class="back-to-top d-block py-1" href="#">Back to top</a>
                <a class="go-to-bottom d-block py-1" href="#">Go to bottom</a>
            </div>
        </div>
    </div>
    <script>
        tocbot.init({
            // Where to render the table of contents.
            tocSelector: '#toc-content',
            // Where to grab the headings to build the table of contents.
            contentSelector: 'article',
            // Which headings to grab inside of the contentSelector element.
            headingSelector: 'h1, h2, h3',
            // For headings inside relative or absolute positioned containers within content.
            hasInnerContainers: true,
        });
    </script>


    <script src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        MathJax.Hub.Config({
            tex2jax:{inlineMath:[['$', '$']]}
        })
    </script>

    


    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer id="footer">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 text-center">
                <ul class="list-inline">
                    

                    

                    

                    

                    

                    
                </ul>
                <p class="copyright footer-author">
                    &copy; 2021-2024 
                    <a rel="external" class="copyright-link" href="" target="_blank">Utaha</a><br/>
                    Powered by <a rel="external" class="copyright-link" href="https://hexo.io/" target="_blank">Hexo</a>  
                    <span class="copyright-split">&nbsp;|&nbsp;&nbsp;</span>
                    Theme <a rel="external" class="copyright-link" href="https://github.com/luswdev/hexo-theme-clean.git" target="_blank">Clean</a>
                    
                    
                        <span id="busuanzi_container_site_uv">
                            <span class="copyright-split">&nbsp;|&nbsp;</span>
                            <i class="fas fa-user-friends"></i>&nbsp;&nbsp;<span id="busuanzi_value_site_uv"></span>&nbsp;
                        </span>
                    
                </p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    <!-- jQuery -->
<script src="//cdn.jsdelivr.net/npm/jquery@2.1.4/dist/jquery.min.js"></script>

<!-- For drop down -->
<script src="//cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>

<!-- Bootstrap -->
<script src="//cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"></script>
<!-- Gallery -->
<script src="//cdn.jsdelivr.net/npm/lightgallery@1.6.11/dist/js/lightgallery-all.min.js"></script>
<!-- Busuanzi -->

    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<!-- Search script -->

<script src="/ctf-note/js/search.js"></script>

<script type="text/javascript">
    $(function () {
        searchFunc( '/ctf-note/search.xml' , 'searchInput', 'searchResult');
    });
</script>



<script src="/ctf-note/js/main.js"></script>



    <!-- Search Modal -->
    <!-- Modal -->
<div class="modal fade" id="searchModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
        <div class="modal-content overflow-auto">
            <div class="modal-header">
                <input type="text" class="form-control" placeholder="Searching Keywords..." id="searchInput">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div id="searchResult">
                    <div class="search-empty text-center text-muted p-5">
                        <i class="far fa-meh"></i>
                    </div>
                </div>
            </div> 
        </div>
    </div>
</div>


</body>
</html>